#!/usr/bin/env bash

# emacsitor:  do not start in background!
# $Revision$
# Copyright 2004,2010 Michael M. Hoffman <mmh1@uw.edu>

# usage: emacsitor [OPTION-OR-FILENAME]...

set -o nounset
set -o pipefail
set -o errexit

_emacs-nox()
{
    if [ -n "${NOT_IN_TERMCAP:-}" ]; then
        TERM=xterm command emacs -nw "$@"
    else
        command emacs -nw "$@"
    fi
}

_emacs-x()
{
    command emacs "$@"
}

if [ "$TERM" == "eterm-color" ]; then
    command emacsclient "$@"
elif [[ "${DISPLAY:$((${#DISPLAY}-2))}" == ":0" || "${DISPLAY:$((${#DISPLAY}-4))}" == ":0.0" ]]; then
    _emacs-x "$@"
else
    _emacs-nox "$@"
fi
